<odoo>
    <data>
         <record id="menu_instance_creation" model="website.menu">
            <field name="name">My Instance Request</field>
            <field name="url">/Create_instance</field>
            <field name="parent_id" ref="website.main_menu"/>
            <field name="sequence">50</field>
        </record>

        <!--        We inherit the principal menu and add instance request portal-->
        <template id="portal_my_home_instances" name="Show Instances" customize_show="True"
                  inherit_id="portal.portal_my_home" priority="20">
            <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
                <t t-call="portal.portal_docs_entry">
                    <t t-set="title">Instances</t>
                    <t t-set="url" t-value="'/my/instances'"/>
                    <t t-set="placeholder_count" t-value="'instances_count'"/>
                </t>
            </xpath>
        </template>

        <!--        Our instance request portal Menu -->
        <template id="portal_my_home_menu_instances" name="Portal layout : instances menu entries"
                  inherit_id="portal.portal_breadcrumbs" priority="20">
            <xpath expr="//ol[hasclass('o_portal_submenu')]" position="inside">
                <li t-if="page_name == 'instances'"
                    t-attf-class="breadcrumb-item #{'active ' if not instances else ''}">
                    <a t-if="instances" t-attf-href="/my/instances?{{ keep_query() }}">Instances</a>
                    <t t-else="">Instances</t>
                </li>
                <!--<li t-if="page_name == 'instance_details'" class="breadcrumb-item active">
                    Details
                </li>-->
                <!--<li t-if="instances" class="breadcrumb-item active">
                        <t t-out="instances.name"/>
                </li>-->
            </xpath>
        </template>


        <template id="portal_my_instances" name="My Instances">
            <t t-call="portal.portal_layout">
                <t t-set="breadcrumbs_searchbar" t-value="True"/>
                <t t-call="portal.portal_searchbar">
                    <t t-set="title">Instances</t>
                </t>
                <t t-if="grouped_instances" t-call="portal.portal_table">
                    <thead>
                        <tr class="active">
                            <th>Designation #</th>
                            <th class="text-center">Created By</th>
                            <th class="text-center">Customer</th>
                            <th class="text-center">Odoo Version</th>
                            <th class="text-center">Limit date</th>
                            <th class="text-center">URL</th>
                            <th class="text-center">State</th>
                        </tr>
                    </thead>
                    <t t-foreach="grouped_instances" t-as="instances">
                        <tbody>
                            <tr t-if="not groupby =='none'" class="table-light">
                                <th t-if="groupby != 'none'" colspan="3">
                                    <span t-field="instances[0].sudo().state"/>
                                </th>
                            </tr>
                        </tbody>
                        <tbody>
                            <tr t-foreach="instances" t-as="instance">
                                <td>
                                    <a t-att-href="">
                                        <span t-field="instance.name"/>
                                    </a>
                                </td>
                                <td class="text-center">
                                    <span t-field="instance.create_uid"/>
                                </td>
                                <td class="text-center">
                                    <span t-field="instance.partner_id"/>
                                </td>
                                <td class="text-center">
                                    <span t-field="instance.odoo_version_id"/>
                                </td>
                                <td class="text-center">
                                    <span t-field="instance.limit_date"/>
                                </td>
                                <td class="text-center">
                                    <span t-field="instance.url"/>
                                </td>
                                <td class="text-center">
                                    <span t-field="instance.sudo().state"/>
                                </td>
                            </tr>
                        </tbody>
                    </t>
                </t>
                <p t-else="">There are currently no instances for your account.</p>
            </t>
        </template>

        <template id="portal_my_instances_fields">
            <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()"/>
            <div t-if="error_message" class="alert alert-danger" role="alert">
                <div class="col-lg-12">
                    <t t-foreach="error_message" t-as="err">
                        <t t-esc="err"/>
                        <br/>
                    </t>
                </div>
            </div>
            <div t-attf-class="mb-3 #{error.get('name') and 'o_has_error' or ''} col-xl-6">
                <label class="col-form-label" for="name">Name</label>
                <input type="text" name="name" t-attf-class="form-control #{error.get('name') and 'is-invalid' or ''}"
                       t-att-value="name or instance.name"/>
            </div>
            <div t-attf-class="mb-3 #{error.get('create_uid') and 'o_has_error' or ''} col-xl-6">
                <label class="col-form-label" for="create_uid">Created By</label>
                <input type="text" name="create_uid"
                       t-attf-class="form-control #{error.get('create_uid') and 'is-invalid' or ''}"
                       t-att-value="create_uid or instance.create_uid"/>
            </div>
            <div t-attf-class="mb-3 #{error.get('partner_id') and 'o_has_error' or ''} col-xl-6">
                <label class="col-form-label" for="partner_id">Customer</label>
                <input type="text" name="partner_id" t-attf-class="form-control #{error.get('partner_id') and 'is-invalid' or ''}"
                       t-att-value="partner_id or instance.partner_id"/>
            </div>
            <div t-attf-class="mb-3 #{error.get('odoo_version_id') and 'o_has_error' or ''} col-xl-6">
                <label class="col-form-label" for="odoo_version_id">Odoo version</label>
                <input type="text" name="odoo_version_id" t-attf-class="form-control #{error.get('odoo_version_id') and 'is-invalid' or ''}"
                       t-att-value="odoo_version_id or instance.odoo_version_id"/>
            </div>
            <div t-attf-class="mb-3 #{error.get('limit_date') and 'o_has_error' or ''} col-xl-6">
                <label class="col-form-label" for="limit_date">Limit date</label>
                <input type="text" name="limit_date" t-attf-class="form-control #{error.get('limit_date') and 'is-invalid' or ''}"
                       t-att-value="limit_date or instance.limit_date"/>
            </div>
            <div t-attf-class="mb-3 #{error.get('url') and 'o_has_error' or ''} col-xl-6">
                <label class="col-form-label" for="url">URL</label>
                <input type="text" name="url"
                       t-attf-class="form-control #{error.get('url') and 'is-invalid' or ''}"
                       t-att-value="url or instance.url"/>
            </div>
            <div t-attf-class="mb-3 #{error.get('state') and 'o_has_error' or ''} col-xl-6">
                <label class="col-form-label" for="state">State</label>
                <input type="text" name="state"
                       t-attf-class="form-control #{error.get('state') and 'is-invalid' or ''}"
                       t-att-value="state or instance.state"/>
            </div>
            <!--<div t-attf-class="mb-3 #{error.get('state') and 'o_has_error' or ''} col-xl-6">
                <label class="col-form-label label-optional" for="state">State</label>
                <select name="state" t-attf-class="form-select #{error.get('state') and 'is-invalid' or ''}">
                    <option value="">select...</option>
                    <t t-foreach="state or []" t-as="state">
                        <option t-att-value="state.id" style="display:none;" t-att-data-country_id="state.country_id.id"
                                t-att-selected="state.id == int(state_id) if state_id else state.id == partner.state_id.id">
                            <t t-esc="state.name"/>
                        </option>
                    </t>
                </select>
            </div>-->
        </template>

        <template id="portal_my_instances_form" name="Instance request">
            <t t-call="portal.portal_layout">
                <t t-set="additional_title">Instance Request Details</t>
                <form action="/my/instances/form" method="post">
                    <div class="row o_portal_details">
                        <div class="col-lg-8">
                            <div class="row">
                                <t t-call="portal.portal_my_instances_fields"/>
                                <input type="hidden" name="redirect" t-att-value="redirect"/>
                            </div>
                            <div class="clearfix">
                                <button type="submit" class="btn btn-primary float-end mb32 ">
                                    Confirm
                                    <span class="fa fa-long-arrow-right"/>
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </t>
        </template>

        <!--        <template id="portal_my_instances_form_view" name="My Instances">-->
        <!--            <xpath expr="//div[hasclass('o_portal_sidebar')]" position="inside">-->
        <!--                <p t-out="instance.name"/>-->
        <!--                <p t-out="instance.create_uid"/>-->
        <!--                <p t-out="instance.partner_id"/>-->
        <!--                <p t-out="instance.odoo_version_id"/>-->
        <!--                <p t-out="instance.limit_date"/>-->
        <!--                <p t-out="instance.url"/>-->
        <!--                <p t-out="instance.state"/>-->
        <!--            </xpath>-->
        <!--        </template>-->
    </data>
</odoo>